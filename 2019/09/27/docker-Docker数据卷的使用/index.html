<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Docker数据卷的使用 | WangYangYang</title><meta name="description" content="Docker数据卷的使用"><meta name="keywords" content="docker"><meta name="author" content="Wang YangYang"><meta name="copyright" content="Wang YangYang"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/theme/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Docker数据卷的使用"><meta name="twitter:description" content="Docker数据卷的使用"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/cover/docker/328a1c97b81a63424984f1e779891021.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Docker数据卷的使用"><meta property="og:url" content="http://wangyangyangisme.github.io/2019/09/27/docker-Docker%E6%95%B0%E6%8D%AE%E5%8D%B7%E7%9A%84%E4%BD%BF%E7%94%A8/"><meta property="og:site_name" content="WangYangYang"><meta property="og:description" content="Docker数据卷的使用"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/cover/docker/328a1c97b81a63424984f1e779891021.jpg"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      now = new Date();
      hour = now.getHours();
      isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://wangyangyangisme.github.io/2019/09/27/docker-Docker%E6%95%B0%E6%8D%AE%E5%8D%B7%E7%9A%84%E4%BD%BF%E7%94%A8/"><link rel="prev" title="Dockerfile定制镜像" href="http://wangyangyangisme.github.io/2019/09/27/docker-Dockerfile%E5%AE%9A%E5%88%B6%E9%95%9C%E5%83%8F/"><link rel="next" title="修改docker默认的存储路径" href="http://wangyangyangisme.github.io/2019/09/27/docker-%E4%BF%AE%E6%94%B9docker%E9%BB%98%E8%AE%A4%E7%9A%84%E5%AD%98%E5%82%A8%E8%B7%AF%E5%BE%84/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"C4QN4OTLJM","apiKey":"c2c026ba64eeb77abd2164975fa41f34","indexName":"wyy","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"cookieDomain":"https://wangyangyangisme.github.io","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: false,
  isFontAwesomeV5: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/theme/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">191</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">20</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">38</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fa fa-image"></i><span> 相册</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movie/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker数据卷的使用"><span class="toc-text">Docker数据卷的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#创建一个数据卷"><span class="toc-text">创建一个数据卷</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#挂载宿主机文件或目录到容器数据卷"><span class="toc-text">挂载宿主机文件或目录到容器数据卷</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建数据卷容器"><span class="toc-text">创建数据卷容器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#备份数据卷"><span class="toc-text">备份数据卷</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#恢复或迁移数据卷"><span class="toc-text">恢复或迁移数据卷</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#删除数据卷"><span class="toc-text">删除数据卷</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker-volume-命令创建数据卷"><span class="toc-text">docker volume 命令创建数据卷</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/cover/docker/328a1c97b81a63424984f1e779891021.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">WangYangYang</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fa fa-image"></i><span> 相册</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movie/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Docker数据卷的使用</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-09-27<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2019-11-06</time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/docker/">docker</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">4.7k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 19 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>评论数:</span><a href="/2019/09/27/docker-Docker%E6%95%B0%E6%8D%AE%E5%8D%B7%E7%9A%84%E4%BD%BF%E7%94%A8/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/09/27/docker-Docker%E6%95%B0%E6%8D%AE%E5%8D%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" itemprop="commentCount"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h1 id="Docker数据卷的使用"><a href="#Docker数据卷的使用" class="headerlink" title="Docker数据卷的使用"></a>Docker数据卷的使用</h1><p>Docker中的数据可以存储在类似于虚拟机磁盘的介质中，在Docker中称为数据卷（Data Volume）。数据卷可以用来存储Docker应用的数据，也可以用来在Docker容器间进行数据共享。</p>
<p>数据卷呈现给Docker容器的形式就是一个目录，支持多个容器间共享，修改也不会影响镜像。使用Docker的数据卷，类似在系统中使用 <code>mount</code>挂载一个文件系统。</p>
<ul>
<li><p>1）一个数据卷是一个特别指定的目录，该目录利用容器的UFS文件系统可以为容器提供一些稳定的特性或者数据共享。数据卷可以在多个容器之间共享。</p>
</li>
<li><p>2）创建数据卷，只要在docker run命令后面跟上-<code>v</code>参数即可创建一个数据卷，当然也可以跟多个-<code>v</code>参数来创建多个数据卷，当创建好带有数据卷的容器后，就可以在其他容器中通过–volumes-froms参数来挂载该数据卷了，而不管该容器是否运行。也可以在Dockerfile中通过VOLUME指令来增加一个或者多个数据卷。</p>
</li>
<li><p>3）如果有一些数据想在多个容器间共享，或者想在一些临时性的容器中使用该数据，那么最好的方案就是你创建一个数据卷容器，然后从该临时性的容器中挂载该数据卷容器的数据。这样，即使删除了刚开始的第一个数据卷容器或者中间层的数据卷容器，只要有其他容器使用数据卷，数据卷都不会被删除的。</p>
</li>
<li><p>4）不能使用docker <code>export</code>、save、<code>cp</code>等命令来备份数据卷的内容，因为数据卷是存在于镜像之外的。备份的方法可以是创建一个新容器，挂载数据卷容器，同时挂载一个本地目录，然后把远程数据卷容器的数据卷通过备份命令备份到映射的本地目录里面。如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> docker run -rm --volumes-from DATA -v $(<span class="built_in">pwd</span>):/backup busybox tar cvf /backup/backup.tar /data</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>5）也可以把一个本地主机的目录当做数据卷挂载在容器上，同样是在docker run后面跟<code>-v</code>参数，不过<code>-v</code>后面跟的不再是单独的目录了，它是<code>[host-dir]:[container-dir]:[rw|ro]</code>这样格式的，<br><code>host-dir</code>是一个绝对路径的地址，如果<code>host-dir</code>不存在，则docker会创建一个新的数据卷，如果<code>host-dir</code>存在，但是指向的是一个不存在的目录，则docker也会创建该目录，然后使用该目录做数据源。</p>
</li>
</ul>
<p>Docker Volume数据卷可以实现：</p>
<ul>
<li>1）绕过“拷贝写”系统，以达到本地磁盘IO的性能，（比如运行一个容器，在容器中对数据卷修改内容，会直接改变宿主机上的数据卷中的内容，所以是本地磁盘IO的性能，而不是先在容器中写一份，最后还要将容器中的修改的内容拷贝出来进行同步。）</li>
<li>2）绕过“拷贝写”系统，有些文件不需要在docker commit打包进镜像文件。</li>
<li>3）数据卷可以在容器间共享和重用数据</li>
<li>4）数据卷可以在宿主和容器间共享数据</li>
<li>5）数据卷数据改变是直接修改的</li>
<li>6）数据卷是持续性的，直到没有容器使用它们。即便是初始的数据卷容器或中间层的数据卷容器删除了，只要还有其他的容器使用数据卷，那么里面的数据都不会丢失。</li>
</ul>
<p>Docker数据持久化：</p>
<p>容器在运行期间产生的数据是不会写在镜像里面的，重新用此镜像启动新的容器就会初始化镜像，会加一个全新的读写入层来保存数据。</p>
<p>如果想做到数据持久化，Docker提供数据卷（Data volume）或者数据容器卷来解决问题，另外还可以通过commit提交一个新的镜像来保存产生的数据。</p>
<h2 id="创建一个数据卷"><a href="#创建一个数据卷" class="headerlink" title="创建一个数据卷"></a>创建一个数据卷</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">如下为容器添加一个数据卷，并将容器名改为data。这个数据卷在容器里的目录是/opt/test_data</span></span><br><span class="line">[root@localhost ~]# docker images ls</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">golang              latest              b860ab44e93e        2 weeks ago         774MB</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# docker run --name test -v /opt/test_data -t -i golang:latest bash</span><br><span class="line">root@4e219a3ca330:/# cd /opt/test_data/</span><br><span class="line">root@4e219a3ca330:/opt/test_data# ls</span><br><span class="line">root@4e219a3ca330:/opt/test_data# echo "test1" &gt; test1</span><br><span class="line">root@4e219a3ca330:/opt/test_data# echo "test2" &gt; test2</span><br><span class="line">root@4e219a3ca330:/opt/test_data# ls</span><br><span class="line">test1  test2</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# docker ps -a</span><br><span class="line">CONTAINER ID  IMAGE         COMMAND       CREATED        STATUS   PORTS     NAMES</span><br><span class="line">4e219a3ca330  golang:latest  "bash"  About a minute ago  Up About a minute   test</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">在宿主机上，查看对应上面的那个数据卷的目录路径：(默认路径/var/lib/docker/volumes)</span></span><br><span class="line">[root@localhost ~]# docker inspect test|grep /home/xxx/docker/volumes</span><br><span class="line">"Source":"/home/xxx/docker/volumes/7a8c9157b67c130524e8a1e660236a8cdb0ad06d00911834e461aa6ed0108a4a/_data"</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# ls /home/xxx/docker/volumes/7a8c9157b67c130524e8a1e660236a8cdb0ad06d00911834e461aa6ed0108a4a/_data</span><br><span class="line">test1  test2</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# echo "hello docker" &gt;&gt; /home/xxx/docker/volumes/7a8c9157b67c130524e8a1e660236a8cdb0ad06d00911834e461aa6ed0108a4a/_data/test1</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">root@4e219a3ca330:/opt/test_data# ls</span><br><span class="line">test1  test2</span><br><span class="line"></span><br><span class="line">root@4e219a3ca330:/opt/test_data# cat test1</span><br><span class="line">test1</span><br><span class="line">hello docker</span><br></pre></td></tr></table></figure>

<h2 id="挂载宿主机文件或目录到容器数据卷"><a href="#挂载宿主机文件或目录到容器数据卷" class="headerlink" title="挂载宿主机文件或目录到容器数据卷"></a>挂载宿主机文件或目录到容器数据卷</h2><p>可以直接挂载宿主机文件或目录到容器里，可以理解为目录映射，这样就可以让所有的容器共享宿主机数据，从而只需要改变宿主机的数据源就能够影响到所有的容器数据。</p>
<p>注意：-v后面的映射关系是”宿主机文件/目录:容器里对应的文件/目录”，其中，宿主机上的文件/目录是要提前存在的，容器里对应的文件/目录会自动创建。</p>
<p>数据卷权限：</p>
<p>挂载的数据默认为可读写权限。<br>但也可以根据自己的需求，将容器里挂载共享的数据设置为只读，这样数据修改就只能在宿主机上操作。如下实例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1）挂载宿主机文件到容器上</span></span><br><span class="line">[root@localhost ~]# cat /home/xxx/test.md</span><br><span class="line">this is a test!</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# docker run -t -i --name test1 -v /home/xxx/test.md:/root/test.md:ro golang:latest bash</span><br><span class="line"></span><br><span class="line">[root@a4731775d780 /]# cat /root/test.md</span><br><span class="line">this is a test!</span><br><span class="line"></span><br><span class="line">[root@a4731775d780 /]# echo "hello everybody" &gt;&gt; /root/test.md</span><br><span class="line">bash: /root/test.md: Read-only file system</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">在宿主机上修改共享数据</span></span><br><span class="line">[root@localhost ~]# echo "hello everybody" &gt;&gt; /home/xxx/test.md</span><br><span class="line">  </span><br><span class="line">[root@e21a3fefa3ae /]# cat /root/test.md</span><br><span class="line">this is a test!</span><br><span class="line">hello everybody</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">2）挂载宿主机目录到容器上</span></span><br><span class="line">[root@localhost ~]# mkdir /home/xxx/test</span><br><span class="line">[root@localhost ~]# echo "test1" &gt; /home/xxx/test/test1</span><br><span class="line">[root@localhost ~]# echo "test2" &gt; /home/xxx/test/test2</span><br><span class="line">[root@localhost ~]# docker run -t -i --name test2 -v /home/xxx/test:/opt/test golang:latest bash</span><br><span class="line">[root@80c36a4936ed /]# cd /opt/test/</span><br><span class="line">[root@80c36a4936ed /opt/test]# ls</span><br><span class="line">test1  test2</span><br><span class="line">[root@80c36a4936ed /opt/test]# cat test1</span><br><span class="line">test1</span><br><span class="line">[root@80c36a4936ed /opt/test]# cat test2</span><br><span class="line">test2</span><br><span class="line">[root@80c36a4936ed /opt/test]# echo "1tset" &gt;&gt;test1</span><br><span class="line">[root@80c36a4936ed /opt/test]# echo "2tset" &gt;&gt;test2</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">宿主机上查看</span></span><br><span class="line">[root@localhost ~]# cat /home/xxx/test/test1</span><br><span class="line">test1</span><br><span class="line">1tset</span><br><span class="line">[root@localhost ~]# cat /home/xxx/test/test2</span><br><span class="line">test2</span><br><span class="line">2tset</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">3）挂载多个目录</span></span><br><span class="line">[root@localhost ~]# mkdir /home/xxx/test1 /home/xxx/test2</span><br><span class="line">[root@localhost ~]# echo "test1" &gt; /home/xxx/test1/test1</span><br><span class="line">[root@localhost ~]# echo "test2" &gt; /home/xxx/test2/test2</span><br><span class="line">[root@localhost ~]# docker run --name test -v /home/xxx/test1:/opt/test1 -v /home/xxx/test1:/opt/test2:ro -t -i golang:latest bash</span><br><span class="line">root@afd2610d83ff:/# ls /opt/test1</span><br><span class="line">test1</span><br><span class="line">root@afd2610d83ff:/# ls /opt/test2</span><br><span class="line">test2</span><br><span class="line">root@afd2610d83ff:/# cat /opt/test1/test1</span><br><span class="line">test1</span><br><span class="line">root@afd2610d83ff:/# cat /opt/test2/test2</span><br><span class="line">test2</span><br><span class="line">root@53d7fc975be0:/# echo "1tset" &gt;&gt; /opt/test1/test1</span><br><span class="line">root@53d7fc975be0:/# echo "2tset" &gt;&gt; /opt/test2/test2</span><br><span class="line">bash: /opt/test2/test2: Read-only file system</span><br></pre></td></tr></table></figure>



<h2 id="创建数据卷容器"><a href="#创建数据卷容器" class="headerlink" title="创建数据卷容器"></a>创建数据卷容器</h2><p>启动一个名为<code>test</code>容器，此容器包含两个数据卷<code>/opt/volume1</code>和<code>/opt/volume2</code>（这两个数据卷目录是在容器里的，容器创建的时候会自动生成这两目录）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">注意一个细节：</span></span><br><span class="line"><span class="meta">#</span><span class="bash">下面的创建命令中，没有加-t和-i参数，所以这个容器创建好之后是登陆不了的！</span></span><br><span class="line"><span class="meta">#</span><span class="bash">-i：表示以“交互模式”运行容器</span></span><br><span class="line"><span class="meta">#</span><span class="bash">-t：表示容器启动后会进入其命令行</span></span><br><span class="line">[root@localhost ~]# docker run -v /opt/volume1 -v /opt/volume2 --name test golang:latest bash</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">所以要想创建容器后能正常登陆，就需要添加上面两个参数</span></span><br><span class="line">[root@localhost ~]# docker run -t -i -v /opt/volume1 -v /opt/volume2 --name test golang:latest bash</span><br></pre></td></tr></table></figure>

<p>查看宿主机上与数据卷对应的目录路径：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker inspect test|grep /home/xxx/docker/volumes</span><br><span class="line">"Source": "/home/xxx/docker/volumes/7e24263d6c4187440f56624ac54fdf1c94ff0b0673f0af5684492cb23deabdb9/_data",</span><br><span class="line">"Source": "/home/xxx/docker/volumes/2b4b8020ed0cb57f2f101211e508850d0644edd4907ee2bc6d23433f08021d90/_data",</span><br><span class="line">由上面命令结果可以查到，两个数据卷/opt/volume1和/opt/volume2下的数据在/home/xxx/docker/volumes/下对于的两个目录的_data下面</span><br></pre></td></tr></table></figure>

<p>创建<code>test1</code>容器，挂载<code>test</code>容器中的数据卷</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker run -t -i --rm --volumes-from test --name test1 golang:latest bash</span><br><span class="line">[root@b9891bcdfed0 /]# ls /opt/volume1                           //发现这两个数据卷都存在</span><br><span class="line">[root@b9891bcdfed0 /]# ls /opt/volume2</span><br><span class="line">[root@b9891bcdfed0 /]# echo "this is volume1" &gt; /opt/volume1/test1</span><br><span class="line">[root@b9891bcdfed0 /]# echo "this is volume2" &gt; /opt/volume2/test2</span><br></pre></td></tr></table></figure>

<p>可以再创建一个容器，挂载test中从test1挂载的数据卷。当然也可以直接挂载初始的test容器数据卷</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker run -t -i --rm --volumes-from test1 --name test2 golang:latest bash</span><br><span class="line">[root@b4c27e360614 /]# ls /opt/volume1</span><br><span class="line">test1</span><br><span class="line">[root@b4c27e360614 /]# ls /opt/volume2</span><br><span class="line">test2</span><br><span class="line">[root@b4c27e360614 /]# cat /opt/volume1/test1 </span><br><span class="line">this is volume1</span><br><span class="line">[root@b4c27e360614 /]# cat /opt/volume2/test2 </span><br><span class="line">this is volume2</span><br></pre></td></tr></table></figure>

<p>即便是删除了初始的数据卷容器test，或是删除了其它容器，但只要是有容器在使用该数据卷，那么它里面的数据就不会丢失！（除非是没有容器在使用它们）</p>
<h2 id="备份数据卷"><a href="#备份数据卷" class="headerlink" title="备份数据卷"></a>备份数据卷</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo docker run -it -v /opt/volume --name <span class="built_in">test</span> golang:latest bash</span></span><br><span class="line">[root@b9891bcdfed0 /]# echo "this is volume" &gt; /opt/volume/test</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo docker run --rm --volumes-from <span class="built_in">test</span> -v $(<span class="built_in">pwd</span>):/backup golang:latest tar cvf /backup/test.tar /opt/volume</span></span><br><span class="line">tar: Removing leading `/' from member names</span><br><span class="line">/opt/volume</span><br><span class="line">/opt/volume/test</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">以上命令表示：</span></span><br><span class="line"><span class="meta">#</span><span class="bash">启动一个新的容器并且从<span class="built_in">test</span>容器中挂载卷，然后挂载当前目录到容器中为backup，并备份<span class="built_in">test</span>卷中所有的数据为test.tar，执行完成之后删除容器--rm，此时备份就在当前的目录下，名为test.tar。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">注意：后面的/<span class="built_in">test</span>是数据卷的目录路径（即数据卷创建时在容器里的路径）</span></span><br><span class="line">  </span><br><span class="line"><span class="meta">$</span><span class="bash"> ls</span></span><br><span class="line"><span class="meta">#</span><span class="bash">宿主机当前目录下产生了<span class="built_in">test</span>卷的备份文件test.tar</span></span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">----------------------------------看看下面的一个实例--------------------------------</span></span><br><span class="line"><span class="meta">#</span><span class="bash">先创建一个容器wang，包含两个数据卷/opt/volume1和/opt/volume2（这两个目录是在容器里的数据卷路径）</span></span><br><span class="line">[root@localhost ~]# docker run -iti -v /var/volume1 -v /var/volume2 --name wang golang:latest bash</span><br><span class="line">[root@83eb43492ae7 /]#</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">根据Docker的数据持久化之数据卷容器可知,上面创建的wang数据卷容器挂载了/var/volume1和/var/volume2两个目录</span></span><br><span class="line"><span class="meta">#</span><span class="bash">然后在数据卷里写些数据，以供测试。</span></span><br><span class="line">[root@83eb43492ae7 /]# cd /var/volume1</span><br><span class="line">[root@83eb43492ae7 volume1]# echo "test1" &gt; test1</span><br><span class="line">[root@83eb43492ae7 volume1]# echo "test11" &gt; test11</span><br><span class="line">[root@83eb43492ae7 volume1]# echo "test111" &gt; test111</span><br><span class="line">[root@83eb43492ae7 volume1]# ls</span><br><span class="line">test1  test11  test111</span><br><span class="line">[root@83eb43492ae7 volume1]# cd ../volume2</span><br><span class="line">[root@83eb43492ae7 volume2]# echo "test2" &gt; test2</span><br><span class="line">[root@83eb43492ae7 volume2]# echo "test22" &gt; test22</span><br><span class="line">[root@83eb43492ae7 volume2]# echo "test222" &gt; test222</span><br><span class="line">[root@83eb43492ae7 volume2]# ls</span><br><span class="line">test2  test22  test222</span><br><span class="line">[root@83eb43492ae7 volume2]#</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">然后进行这两个数据卷的备份</span></span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID IMAGE         COMMAND   CREATED        STATUS    PORTS    NAMES</span><br><span class="line">83eb43492ae7 golang:latest "bash"  2 minutes ago  Up 2 minutes         wang</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">现在开始进行数据卷的备份操作：</span></span><br><span class="line"><span class="meta">#</span><span class="bash">为了利用数据卷容器备份,使用--volumes-from标记来创建一个加载wang容器卷的容器，并从主机挂载当前目录到容器的/backup目录。并备份wang卷中的数据，执行完成之后删除容器--rm，此时备份就在当前的目录下了。</span></span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">1）备份wang容器中的/var/volume1数据卷数据&lt;strong&gt;（注意下面：命令中的-i和-t这两个参数加不加都可以；--rm加上，备份后就会自动删除这个容器，如果不加这个--rm参数，那么备份后的容器就会保留，docker ps -a就会查看到）&lt;/strong&gt;</span></span><br><span class="line">[root@localhost ~]# docker run -i -t --rm --volumes-from wang -v $(pwd):/backup golang:latest tar cvf /backup/backup1.tar /var/volume1</span><br><span class="line">tar: Removing leading `/' from member names</span><br><span class="line">/var/volume1/</span><br><span class="line">/var/volume1/test1</span><br><span class="line">/var/volume1/test11</span><br><span class="line">/var/volume1/test111</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">2）备份wang容器中的/var/volume2数据卷数据</span></span><br><span class="line">[root@localhost ~]# docker run -i -t --rm --volumes-from wang -v $(pwd):/backup golang:latest tar cvf /backup/backup2.tar /var/volume2</span><br><span class="line">tar: Removing leading `/' from member names</span><br><span class="line">/var/volume2/</span><br><span class="line">/var/volume2/test2</span><br><span class="line">/var/volume2/test22</span><br><span class="line">/var/volume2/test222</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">3）备份wang容器中的/var/volume1和/var/volume2数据卷数据</span></span><br><span class="line">[root@localhost ~]# docker run -i -t --rm --volumes-from wang -v $(pwd):/backup golang:latest tar cvf /backup/backup.tar /var/volume1 /var/volume2</span><br><span class="line">tar: Removing leading `/' from member names</span><br><span class="line">/var/volume1/</span><br><span class="line">/var/volume1/test1</span><br><span class="line">/var/volume1/test11</span><br><span class="line">/var/volume1/test111</span><br><span class="line">/var/volume2/</span><br><span class="line">/var/volume2/test2</span><br><span class="line">/var/volume2/test22</span><br><span class="line">/var/volume2/test222</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# ls</span><br><span class="line">anaconda-ks.cfg  a.py  backup1.tar  backup2.tar  backup.tar  mkimage-yum.sh  pipework  var  wang.tar</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">这样,数据卷容器中的数据就备份完成了. 简言之就是：</span></span><br><span class="line"><span class="meta">#</span><span class="bash">先创建一个容器，并挂载要备份的容器数据卷，再挂载数据卷(<span class="built_in">pwd</span>):/backup目录到容器/bakcup，在容器中执行备份/data目录到/backup，也就是备份到宿主机$(<span class="built_in">pwd</span>):/backup目录。</span></span><br></pre></td></tr></table></figure>

<h2 id="恢复或迁移数据卷"><a href="#恢复或迁移数据卷" class="headerlink" title="恢复或迁移数据卷"></a>恢复或迁移数据卷</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">可以恢复给同一个容器或者另外的容器，新建容器并解压备份文件到新的容器数据卷</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo docker run -t -i -d -v /<span class="built_in">test</span> --name test4 golang:latest  bash</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo docker run --rm --volumes-from test4 -v $(<span class="built_in">pwd</span>):/backup ubuntu:14.04 tar xvf /backup/test.tar -C /</span></span><br><span class="line"><span class="meta">#</span><span class="bash">恢复之前的文件到新建卷中，执行完后自动删除容器 <span class="built_in">test</span>/ <span class="built_in">test</span>/b <span class="built_in">test</span>/d <span class="built_in">test</span>/c <span class="built_in">test</span>/a</span></span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">-----------------------------接着上面的实例进行数据卷恢复操作--------------------------</span></span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID  IMAGE        COMMAND    CREATED         STATUS   PORTS    NAMES</span><br><span class="line">531c9d8adf4c  golang:latest "bash" 2 minutes ago   Up 44 seconds         wang</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">1）恢复数据给同一个容器</span></span><br><span class="line"><span class="meta">#</span><span class="bash">测了测试效果，先删除数据卷（注意：数据卷目录删除不了，只能删除其中的数据。）</span></span><br><span class="line">[root@localhost ~]# docker attach wang</span><br><span class="line">[root@531c9d8adf4c ~]# ls /var/volume1</span><br><span class="line">test1  test11  test111</span><br><span class="line">[root@531c9d8adf4c ~]# ls /var/volume2</span><br><span class="line">test2  test22  test222</span><br><span class="line">[root@531c9d8adf4c ~]# rm -rf /var/volume1 /var/volume2</span><br><span class="line">rm: cannot remove '/var/volume1': Device or resource busy </span><br><span class="line">rm: cannot remove '/var/volume2': Device or resource busy</span><br><span class="line">[root@531c9d8adf4c ~]# ls /var/volume2</span><br><span class="line">[root@531c9d8adf4c ~]# ls /var/volume1</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">现在进行数据卷恢复，恢复数据卷中的所有数据：</span></span><br><span class="line">[root@localhost ~]# ls</span><br><span class="line">anaconda-ks.cfg  a.py  backup1.tar  backup2.tar  backup.tar  mkimage-yum.sh  pipework  var  wang.tar</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">注意-C后面的路径，这个路径表示将数据恢复到容器里的路径。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">命令中用<span class="string">"/"</span>，即表示将backup.tar中的数据解压到容器的/路径下。后面跟什么路径，就解压到这个路径下。因此这里用<span class="string">"/"</span></span></span><br><span class="line">[root@localhost ~]# docker run --rm --volumes-from wang -v $(pwd):/backup golang:latest tar xvf /backup/backup.tar -C /</span><br><span class="line">var/volume1/</span><br><span class="line">var/volume1/test1</span><br><span class="line">var/volume1/test11</span><br><span class="line">var/volume1/test111</span><br><span class="line">var/volume2/</span><br><span class="line">var/volume2/test2</span><br><span class="line">var/volume2/test22</span><br><span class="line">var/volume2/test222</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">再次到容器里查看，发现数据卷里的数据已经恢复了</span></span><br><span class="line">[root@531c9d8adf4c ~]# ls /var/volume1</span><br><span class="line">test1  test11  test111</span><br><span class="line">[root@531c9d8adf4c ~]# ls /var/volume2</span><br><span class="line">test2  test22  test222</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">2）恢复数据给另外的容器，新建容器并解压备份文件到新的容器数据卷</span></span><br><span class="line"><span class="meta">#</span><span class="bash">即新建一个容器huihui，将上面备份的数据卷数据恢复到这个新容器里。</span></span><br><span class="line">[root@localhost ~]# docker run -t -i -v /var/volume1 -v /var/volume2 --name huihui golang:latest bash</span><br><span class="line">[root@f6ff380e0b7f var]# ls /var/volume1</span><br><span class="line">[root@f6ff380e0b7f var]# ls /var/volume2</span><br><span class="line">  </span><br><span class="line">[root@localhost ~]# ls</span><br><span class="line">anaconda-ks.cfg  a.py  backup1.tar  backup2.tar  backup.tar  mkimage-yum.sh  pipework  var  wang.tar</span><br><span class="line">  </span><br><span class="line">[root@localhost ~]# docker run --rm --volumes-from huihui -v $(pwd):/backup docker.io/centos tar xvf /backup/backup.tar -C /</span><br><span class="line">var/volume1/</span><br><span class="line">var/volume1/test1</span><br><span class="line">var/volume1/test11</span><br><span class="line">var/volume1/test111</span><br><span class="line">var/volume2/</span><br><span class="line">var/volume2/test2</span><br><span class="line">var/volume2/test22</span><br><span class="line">var/volume2/test222</span><br><span class="line">  </span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE       COMMAND    CREATED          STATUS     PORTS  NAMES</span><br><span class="line">813afe297b60 golang:latest "bash"   17 seconds ago  Up 16 seconds        huihui</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">这里注意一下：</span></span><br><span class="line"><span class="meta">#</span><span class="bash">新容器创建时挂载的数据卷路径最好是和之前备份的数据卷路径一致</span></span><br><span class="line"><span class="meta">#</span><span class="bash">如下：</span></span><br><span class="line"><span class="meta">#</span><span class="bash">1）新建容器挂载的数据卷只是备份数据卷的一部分，那么恢复的时候也只是恢复一部分数据。如下，新容器创建时只挂载/var/volume1</span></span><br><span class="line">[root@localhost ~]# docker run -t -i -v /var/volume1 --name huihui golang:latest bash</span><br><span class="line">[root@12dd8d742259 /]# ls /var/volume1/</span><br><span class="line">[root@12dd8d742259 /]# ls /var/volume2</span><br><span class="line">ls: cannot access /var/volume2: No such file or directory</span><br><span class="line">  </span><br><span class="line">[root@localhost ~]# docker run --rm --volumes-from huihui -v $(pwd):/backup docker.io/centos tar xvf /backup/backup.tar -C /</span><br><span class="line">var/volume1/</span><br><span class="line">var/volume1/test1</span><br><span class="line">var/volume1/test11</span><br><span class="line">var/volume1/test111</span><br><span class="line">var/volume2/</span><br><span class="line">var/volume2/test2</span><br><span class="line">var/volume2/test22</span><br><span class="line">var/volume2/test222</span><br><span class="line">[root@localhost ~]#</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">查看容器，发现只恢复了/var/volume1的数据，/var/volume2数据没有恢复，因为没有容器创建时没有挂载这个。</span></span><br><span class="line">[root@localhost ~]# docker run -t -i -v /var/volume1 --name huihui golang:latest bash</span><br><span class="line">[root@12dd8d742259 /]# ls /var/volume1/</span><br><span class="line">[root@12dd8d742259 /]# ls /var/volume2</span><br><span class="line">ls: cannot access /var/volume2: No such file or directory</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">2）新容器创建时只挂载/var/volume2</span></span><br><span class="line">[root@localhost ~]# docker run -t -i -v /var/volume2 --name huihui golang:latest bash</span><br><span class="line">[root@da3a3d2c95e0 /]# ls /var/volume2/</span><br><span class="line">[root@da3a3d2c95e0 /]# ls /var/volume1</span><br><span class="line">ls: cannot access /var/volume1: No such file or directory</span><br><span class="line">  </span><br><span class="line">[root@localhost ~]# docker run --rm --volumes-from huihui -v $(pwd):/backup golang:latest tar xvf /backup/backup.tar -C /</span><br><span class="line">var/volume1/</span><br><span class="line">var/volume1/test1</span><br><span class="line">var/volume1/test11</span><br><span class="line">var/volume1/test111</span><br><span class="line">var/volume2/</span><br><span class="line">var/volume2/test2</span><br><span class="line">var/volume2/test22</span><br><span class="line">var/volume2/test222</span><br><span class="line">[root@localhost ~]#</span><br><span class="line">  </span><br><span class="line">[root@da3a3d2c95e0 /]# ls /var/volume1</span><br><span class="line">ls: cannot access /var/volume1: No such file or directory</span><br><span class="line">[root@da3a3d2c95e0 /]# ls /var/volume2/</span><br><span class="line">test2  test22  test222</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">3)如果新容器创建时挂载的数据卷目录跟之前备份的路径不一致</span></span><br><span class="line">[root@localhost ~]# docker run -t -i -v /var/huihui --name huihui golang:latest bash</span><br><span class="line">[root@9bad9b3bde71 /]# ls /var/huihui/</span><br><span class="line">[root@9bad9b3bde71 /]#</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">如果解压时-C后面跟的路径不是容器挂载的容器，那么数据恢复不了，如下</span></span><br><span class="line">[root@localhost ~]# docker run --rm --volumes-from huihui -v $(pwd):/backup golang:latest tar xvf /backup/backup.tar -C /</span><br><span class="line">var/volume1/</span><br><span class="line">var/volume1/test1</span><br><span class="line">var/volume1/test11</span><br><span class="line">var/volume1/test111</span><br><span class="line">var/volume2/</span><br><span class="line">var/volume2/test2</span><br><span class="line">var/volume2/test22</span><br><span class="line">var/volume2/test222</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">发现容器内数据没有恢复</span></span><br><span class="line">[root@9bad9b3bde71 /]# ls /var/huihui/</span><br><span class="line">[root@9bad9b3bde71 /]#</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">但是如果解压时-C后面跟的是容器挂载的路径，数据就能正常恢复</span></span><br><span class="line">[root@localhost ~]# docker run --rm --volumes-from huihui -v $(pwd):/backup golang:latest tar xvf /backup/backup.tar -C /var/huihui</span><br><span class="line">var/volume1/</span><br><span class="line">var/volume1/test1</span><br><span class="line">var/volume1/test11</span><br><span class="line">var/volume1/test111</span><br><span class="line">var/volume2/</span><br><span class="line">var/volume2/test2</span><br><span class="line">var/volume2/test22</span><br><span class="line">var/volume2/test222</span><br><span class="line">[root@localhost ~]#</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">发现容器内数据已经恢复了</span></span><br><span class="line">[root@9bad9b3bde71 /]# ls /var/huihui/</span><br><span class="line">var</span><br><span class="line">[root@9bad9b3bde71 /]# ls /var/huihui/var/</span><br><span class="line">volume1  volume2</span><br><span class="line">[root@9bad9b3bde71 /]# ls /var/huihui/var/volume1</span><br><span class="line">test1  test11  test111</span><br><span class="line">[root@9bad9b3bde71 /]# ls /var/huihui/var/volume2</span><br><span class="line">test2  test22  test222</span><br></pre></td></tr></table></figure>



<h2 id="删除数据卷"><a href="#删除数据卷" class="headerlink" title="删除数据卷"></a>删除数据卷</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">Volume 只有在下列情况下才能被删除：</span></span><br><span class="line"><span class="meta">#</span><span class="bash">1）docker rm -v删除容器时添加了-v选项</span></span><br><span class="line"><span class="meta">#</span><span class="bash">2）docker run --rm运行容器时添加了--rm选项</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">否则，会在/var/lib/docker/volumes目录中遗留很多不明目录。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">可以使用下面方式找出，然后删除_data目录下的数据文件</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">默认/var/lib/docker/volumes</span></span><br><span class="line">[root@localhost volumes]# docker inspect test|grep /home/xxx/docker/volumes</span><br><span class="line">                "Source": "/home/xxx/docker/volumes/97aa95420e66de20abbe618fad8d0c1da31c54ce97e32a3892fa921c7942d42b/_data",</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">可以使用 docker rm -v 命令在删除容器时删除该容器的卷。示例如下：</span></span><br><span class="line">[root@localhost volumes]# docker run -d -P --name test -v /www golang:latest</span><br><span class="line">69199905a74cb360935e32f4e99f7f11319f6aa36033a920aa0bae25874f5c69</span><br><span class="line"> </span><br><span class="line">[root@localhost volumes]# docker volume ls</span><br><span class="line">DRIVER              VOLUME NAME</span><br><span class="line">local               5341c03f3b94f13f4c86d88ccb0f3b63487adf30dea7ae6b2d06e947235e7330</span><br><span class="line">local               97aa95420e66de20abbe618fad8d0c1da31c54ce97e32a3892fa921c7942d42b</span><br><span class="line">local               data_volume</span><br><span class="line"> </span><br><span class="line">[root@localhost volumes]# docker rm -vf test</span><br><span class="line">huihui</span><br><span class="line">[root@localhost volumes]# docker volume ls</span><br><span class="line">DRIVER              VOLUME NAME</span><br><span class="line">local               5341c03f3b94f13f4c86d88ccb0f3b63487adf30dea7ae6b2d06e947235e7330</span><br><span class="line">local               data_volume</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">删除数据卷</span></span><br><span class="line">[root@localhost volumes]# docker volume rm kevin</span><br></pre></td></tr></table></figure>

<h2 id="docker-volume-命令创建数据卷"><a href="#docker-volume-命令创建数据卷" class="headerlink" title="docker volume 命令创建数据卷"></a>docker volume 命令创建数据卷</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">Docker 新版本中引入了 docker volume 命令来管理 Docker volume。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">使用默认的 <span class="string">'local'</span> driver 创建一个volume数据卷</span></span><br><span class="line">[root@localhost ~]# docker volume create --name kevin</span><br><span class="line">kevin</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# docker volume ls</span><br><span class="line">DRIVER              VOLUME NAME</span><br><span class="line">local               kevin</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">默认/var/lib/docker/volumes</span></span><br><span class="line">[root@localhost ~]# ll /home/xxx/docker/volumes</span><br><span class="line">total 24</span><br><span class="line">drwxr-xr-x 3 root root    19 Oct 28 00:32 kevin</span><br><span class="line">-rw------- 1 root root 32768 Oct 28 00:32 metadata.db</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">使用这个名为kevin的数据卷</span></span><br><span class="line">[root@localhost ~]# docker run -d -P --name test1 -v kevin:/volume golang:latest</span><br><span class="line">375ef74722404f5c52fde9f2ea7ea322c57e07fbac0b0e69825f077328fdb363</span><br><span class="line"> </span><br><span class="line">[root@localhost ~]# docker inspect test1</span><br><span class="line">.........</span><br><span class="line"> "Mounts": [</span><br><span class="line">            &#123;</span><br><span class="line">                "Type": "volume",</span><br><span class="line">                "Name": "kevin",</span><br><span class="line">                "Source": "/home/xxx/docker/volumes/kevin/_data",</span><br><span class="line">                "Destination": "/volume",</span><br><span class="line">                "Driver": "local",</span><br><span class="line">                "Mode": "z",</span><br><span class="line">                "RW": true,</span><br><span class="line">                "Propagation": ""</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">将kevin数据卷对应在本机的目录/home/xxx/docker/volumes/kevin/_data挂载给容器内的/volume目录。</span></span><br></pre></td></tr></table></figure>

</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:null">Wang YangYang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://wangyangyangisme.github.io/2019/09/27/docker-Docker%E6%95%B0%E6%8D%AE%E5%8D%B7%E7%9A%84%E4%BD%BF%E7%94%A8/">http://wangyangyangisme.github.io/2019/09/27/docker-Docker%E6%95%B0%E6%8D%AE%E5%8D%B7%E7%9A%84%E4%BD%BF%E7%94%A8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://wangyangyangisme.github.io" target="_blank">WangYangYang</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/docker/">docker</a></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=null" async="async"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/donat/76bc52296bcf2e0b7a1d628106ffcd52.png" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/donat/fab2285fdcd13ead0a8b4a853c659d03.jpg" alt="支付宝"/><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2019/09/27/docker-Dockerfile%E5%AE%9A%E5%88%B6%E9%95%9C%E5%83%8F/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/cover/docker/e280494352cc40c8b1b010cb45cfd680.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Dockerfile定制镜像</div></div></a></div><div class="next-post pull_right"><a href="/2019/09/27/docker-%E4%BF%AE%E6%94%B9docker%E9%BB%98%E8%AE%A4%E7%9A%84%E5%AD%98%E5%82%A8%E8%B7%AF%E5%BE%84/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/cover/docker/f5a85bca8780bdcd5c12bc67bdf0c4cc.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">修改docker默认的存储路径</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2019/10/14/CICD-Jenkins+Gogs搭建自动化部署平台/" title="Jenkins+Gogs搭建自动化部署平台"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/cover/jenkins/a417502fb456faa4905da180b5f3df8d.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-10-14</div><div class="relatedPosts_title">Jenkins+Gogs搭建自动化部署平台</div></div></a></div><div class="relatedPosts_item"><a href="/2019/10/14/docker-docker网络模式/" title="docker网络模式"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/cover/docker/c38765c6716b20d094b144d9523f5c77.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-10-14</div><div class="relatedPosts_title">docker网络模式</div></div></a></div><div class="relatedPosts_item"><a href="/2019/10/11/docker-docker_compose_yaml常用指令/" title="docker-compose.yaml常用指令"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/cover/docker/ca1b0be2508c83291521bb8d9c2b2b5a.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-10-11</div><div class="relatedPosts_title">docker-compose.yaml常用指令</div></div></a></div><div class="relatedPosts_item"><a href="/2019/10/11/docker-docker部署gogs、gitea/" title="docker部署gogs/gitea"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/cover/docker/36898a8a7bef92e00cf86d39463cbc62.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-10-11</div><div class="relatedPosts_title">docker部署gogs/gitea</div></div></a></div><div class="relatedPosts_item"><a href="/2019/10/04/docker-docker部署Registry仓库/" title="docker部署Registry仓库（废）"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/cover/docker/61897c19518f14e06aa21a9f1e39316f.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-10-04</div><div class="relatedPosts_title">docker部署Registry仓库（废）</div></div></a></div><div class="relatedPosts_item"><a href="/2019/09/27/docker-Docker快速入门—Docker-Compose/" title="Docker快速入门—Docker-Compose"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/wangyangyangisme/CDN@latest/cover/docker/45134e544eb1ce316c5b8d3c9dedc071.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-09-27</div><div class="relatedPosts_title">Docker快速入门—Docker-Compose</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify: true,
  verify: false,
  appId: '49gEIIGN7uRbL6vHhieSpBzM-MdYXbMMI',
  appKey: 'uqts0urLKwikYQ0fKmIkMHBE',
  placeholder: '请留下你的脚印',
  avatar: 'monsterid',
  meta: guest_info,
  pageSize: '10',
  lang: 'zh-cn',
  recordIP: false,
  serverURLs: ''
});</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By Wang YangYang</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://wangyangyangisme.github.io/">blog</a>!</div><div class="icp"><a><img class="icp-icon" src="/img/icp.png"/><span></span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="/js/third-party/click_heart.js"></script><script src="/js/search/algolia.js"></script></body></html>